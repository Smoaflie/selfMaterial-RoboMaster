# é¡¹ç›®ä»‹ç»

è°ƒ éº¦è½®åº•ç›˜+äº‘å° ï¼Œå®žçŽ°å…¨å‘ç§»åŠ¨ã€åº•ç›˜è·Ÿéšã€å°é™€èžºç­‰åŸºç¡€åŠŸèƒ½

ä½¿ç”¨äº†freeRTOS V2

# ç›¸å…³è®¾ç½®

åº•ç›˜è½®ç»„ç”µæœºç”µè°ƒIDä¸º1-4ï¼Œäº‘å°6020ç”µæœº(Yawè½´)çš„ç”µè°ƒIDä¸º1ï¼Œäº‘å°6020ç”µæœº(Pitchè½´)çš„ç”µè°ƒIDä¸º5

# é¡¹ç›®å†…å®¹

- **é¥æŽ§å™¨ï¼š**`å·¦æ‘‡æ†`-æŽ§åˆ¶`äº‘å°`(Pitch Yaw)    `å³æ‘‡æ†`-æŽ§åˆ¶`åº•ç›˜`(å…¨å‘ç§»åŠ¨)

- **åº•ç›˜ï¼š**é¥æŽ§å™¨æŽ§åˆ¶-é€Ÿåº¦æ­£å¸¸ï¼Œè¦å¯åŠ¨å¿«åœå¾—ç¨³ã€‚

- **äº‘å°ï¼š**Pitch å’Œ Yaw è½´ç”µæœºæŽ§åˆ¶å®šè§’åº¦ï¼Œä¸è¶…è°ƒï¼Œä¸æŠ–åŠ¨ï¼Œååº”å¿«ã€‚

- **åº•ç›˜è·Ÿéšï¼š**Yaw è½´æ—‹è½¬ï¼ŒæŽ§åˆ¶åº•ç›˜è·Ÿéšæ—‹è½¬ï¼Œæ—‹è½¬æ—¶åº•ç›˜ä¸è¶…è°ƒã€ä¸æŠ–åŠ¨ã€‚

## ç»†åˆ™:

æŽ§åˆ¶äº‘å°Yawè½´æ—¶ï¼š
- `è·Ÿéšæ¨¡å¼`ä¸‹æ‘‡æ†æŽ§åˆ¶çš„æ˜¯äº‘å°çš„ä½ç½®  ï¼ˆå³ï¼šç”¨æ‰‹æ‰­è½¬äº‘å°ï¼Œæ¾æ‰‹åŽä¼šå¿«é€Ÿè½¬å›žåŽŸä½ç½®ï¼‰

- ~~`äº‘å°è‡ªç”±ç§»åŠ¨`ä¸‹æ‘‡æ†æŽ§åˆ¶çš„æ˜¯äº‘å°è½¬åŠ¨çš„é€Ÿåº¦å’Œæ–¹å‘  ï¼ˆå³ï¼šç”¨æ‰‹æ‰­è½¬äº‘å°ï¼Œæ¾æ‰‹åŽä¸å›žåŽŸä½ï¼‰~~

> è¿™æ˜¯è€5å·å…¨å‘è½®çš„é€»è¾‘ï¼Œæš‚ä¸çŸ¥é“äº‘å°æŽ§åˆ¶åˆ†ä¸ºä¸¤ç§æ¨¡å¼çš„åŽŸå› ï¼Œä»¥åŽä¸Šè½¦çš„æ—¶å€™éœ€è¯¢é—®è§†è§‰å–œæ¬¢å“ªç§æ–¹æ¡ˆ

å¯¹äºŽåº•ç›˜è·Ÿéšæ¨¡å¼ï¼š

- åº•ç›˜è·Ÿéšè®¾ç½®1-2Â°ï¼ˆåº•ç›˜çš„æ—‹è½¬ï¼‰æ­»åŒºï¼Œé˜²æ­¢æŒç»­æ—‹è½¬

æ¨¡å¼æŽ§åˆ¶ï¼š

> **æ‹¨æ†åŒä¸Šæ—¶**ï¼Œäº‘å°åº•ç›˜èƒ½è¢«æ­£å¸¸æŽ§åˆ¶ï¼Œä¸”åº•ç›˜é€Ÿåº¦ä¸ºæ­£å¸¸æ¨¡å¼ã€‚
>
> **å·¦ä¸Šå³ä¸­æ—¶**ï¼Œäº‘å°åº•ç›˜èƒ½è¢«æ­£å¸¸æŽ§åˆ¶ï¼Œä¸”åº•ç›˜é€Ÿåº¦ä¸ºé«˜é€Ÿæ¨¡å¼ã€‚
>
> **å·¦ä¸Šå³ä¸‹æ—¶**ï¼Œäº‘å°èƒ½è¢«æ­£å¸¸æŽ§åˆ¶ï¼Œåº•ç›˜ä¸ºå°é™€èžºæ¨¡å¼ã€‚ 
>
> **å·¦ä¸­å³ä¸Šæ—¶**ï¼Œåº•ç›˜åœè½¬ï¼Œäº‘å°è‡ªç”±ç§»åŠ¨ã€‚
> 
> **æ‹¨æ†åŒä¸­æ—¶**ï¼Œé‡æ–°è®¾ç½®äº‘å°ç›¸å¯¹äºŽåº•ç›˜çš„æ–¹å‘ï¼ˆpitchè½´ä¼šæŽ‰ä¸‹æ¥ï¼‰ã€‚
>
> **æ‹¨æ†åŒä¸‹æ—¶**ï¼Œäº‘å°æ— åŠ›ï¼Œåº•ç›˜é€Ÿåº¦ä¿æŒä¸º 0ã€‚

# é£Ÿç”¨æŽ¨è

æ‰€æœ‰ä»£ç æ–‡ä»¶éƒ½åœ¨`/User`æ–‡ä»¶å¤¹ä¸‹

å‚è€ƒä»¥ä¸‹ç›®å½•ç»“æž„ï¼Œç›¸å…³å‡½æ•°çš„åŠŸèƒ½è¯·æŸ¥çœ‹æ³¨é‡Š

```
ðŸ“¦User
 â”£ ðŸ“‚Chassis			#åº•ç›˜
 â”ƒ â”£ ðŸ“œchassis.c		#chassis_task
 â”ƒ â”— ðŸ“œchassis.h
 â”£ ðŸ“‚Controller			#æŽ§åˆ¶å™¨
 â”ƒ â”£ ðŸ“œcontroller.c		#controller_task
 â”ƒ â”— ðŸ“œcontroller.h
 â”£ ðŸ“‚Gimbal				#äº‘å°
 â”ƒ â”£ ðŸ“œgimbal.c			#gimbal_task
 â”ƒ â”— ðŸ“œgimbal.h
 â”£ ðŸ“‚Gyro				#é™€èžºä»ª
 â”ƒ â”£ ðŸ“œbmi088_driver.c
 â”ƒ â”£ ðŸ“œbmi088_driver.h
 â”ƒ â”£ ðŸ“œbmi088_reg.h
 â”ƒ â”£ ðŸ“œgyro.c			#gyro_task
 â”ƒ â”£ ðŸ“œgyro.h
 â”ƒ â”— ðŸ“œtype_define.h
 â”£ ðŸ“‚motor				#ç”µæœº
 â”ƒ â”£ ðŸ“œmotor.c
 â”ƒ â”£ ðŸ“œmotor.h
 â”ƒ â”£ ðŸ“œpid.c
 â”ƒ â”£ ðŸ“œpid.h
 â”ƒ â”£ ðŸ“œusr_CAN.c		#CANé…ç½®
 â”ƒ â”— ðŸ“œusr_CAN.h
 â”£ ðŸ“œusr_main.c			#ä»£æ›¿ main.c - init_
 â”— ðŸ“œusr_main.h
```

# CHANGELOG

12.5  -ä¸Šæ‰‹äº†ä¸‹æˆ˜é˜Ÿå†…çš„äº”å·å…¨å‘è½®ï¼Œé‡æ–°åˆ¶å®šæ“ä½œé€»è¾‘ï¼Œæ”¹ç”¨åŒçŽ¯PID

12.5-12.14 ver1- å·²å®Œå…¨å®žçŽ°é¢„æƒ³åŠŸèƒ½(è°ƒäº†å¥½ä¹…çš„Pitchè½´ï¼Œå‘çŽ°æ˜¯CANé€šä¿¡å‡ºäº†é—®é¢˜â€¦â€¦)

> - ä¿®æ”¹CANå‘é€å‡½æ•°ï¼Œå¹¶åœ¨è¿žç»­çš„CANå‘é€é—´å¢žåŠ é—´éš”ï¼ˆå³ç­‰å¾…ç¬¬ä¸€æ¬¡CANå‘é€å®ŒæˆåŽå†è¿›è¡Œä¹‹åŽçš„ä¸¤æ¬¡è¿žç»­å‘é€ï¼‰
>   - ç»æµ‹è¯•ï¼ŒCANæ€»çº¿çŸ­æ—¶é—´å†…åªèƒ½è¿žç»­å‘ä¸¤ä¸ªåŒ…ï¼ŒåŽŸå› ä¸æ˜Ž
> - å–æ¶ˆå®šæ—¶å™¨TIM3çš„ä½¿ç”¨
>   - å‘çŽ°Pitchè½´å¯¹æ—¶é—´æœ‰è¾ƒé«˜çš„è¦æ±‚ï¼Œå¦‚ä½¿ç”¨ï¼ˆ1000Hzï¼‰å®šæ—¶å™¨å®šæ—¶å‘é€æ•°æ®ä¼šå­˜åœ¨æ˜Žæ˜¾æŠ–åŠ¨
> - äº‘å°ç”µæœºçš„é€Ÿåº¦çŽ¯å‚æ•°ç”±åŽŸ`è½¬å­é€Ÿåº¦`å…¨æ›´æ”¹ä¸º`é™€èžºä»ªè§’é€Ÿåº¦`
>   - é™€èžºä»ªè§’é€Ÿåº¦ç²¾åº¦æ¯”è½¬å­é€Ÿåº¦æ›´é«˜
> - åˆ é™¤äº‘å°ç”µæœºæ­»åŒºè®¾ç½®
> - é™ä½Žå°é™€èžºçŠ¶æ€çš„ç§»åŠ¨é€Ÿåº¦
> - åˆ é™¤æ€¥åœä»£ç 
>   - ~~å†™äº†ç­‰äºŽæ²¡å†™ï¼Œç”¨ä¸äº†ä¸€ç‚¹~~
> - æ— æ³•å®žçŽ°åœ¨`äº‘å°è‡ªç”±æ¨¡å¼`æ—¶`ç”¨æ‰‹æ‰­è½¬äº‘å°ï¼Œæ¾æ‰‹åŽä¸å›žåŽŸä½`
> - ä»ä¿ç•™éƒ¨åˆ†æµ‹è¯•ç”¨çš„ä»£ç ï¼ˆä¾‹å¦‚è°ƒPIDçš„æ­£å¼¦æ›²çº¿ã€æ€¥åœç­‰ï¼‰
>   - ~~æ‡’å¾—åˆ äº†~~
> - åŠ äº†ä¸ªå…¨å‘è½®çš„ç§»åŠ¨å‡½æ•°
>   - ~~å’ŒåŽŸéº¦å…‹çº³å§†è½®çš„ç§»åŠ¨å‡½æ•°æ²¡åŒºåˆ«~~
> - ä¼˜åŒ–ç›®å½•ç»“æž„
> - ä¼˜åŒ–æ–‡æ¡£å†…å®¹ï¼ŒåŠ å…¥è·¯å¾„æ ‘æ–¹ä¾¿æŸ¥é˜…
> - ä¼˜åŒ–æ•´ä½“ä»£ç çš„å¯è¯»æ€§å’Œé€»è¾‘æ€§

12.14-12.15 ver2 - å°†ä»£ç æ”¾åˆ°FreeRTOSä¸­

> - å¢žåŠ äº‘å°Pitchè½´é™ä½ï¼ˆé€šè¿‡æœºæ¢°è§’åº¦ï¼‰
> - ä¿®æ”¹æŽ§åˆ¶å™¨é€»è¾‘ï¼ˆå·¦æ‘‡æ†æŽ§åˆ¶äº‘å°ï¼Œå³æ‘‡æ†æŽ§åˆ¶åº•ç›˜ï¼‰'
> - ~~æ²¡æœ‰æ•´ç†ä»£ç ~~
> - ï¼ˆå®Œï¼‰
